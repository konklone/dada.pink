<style>img, blockquote, pre { width: 75%; margin-bottom: 50%; font-size: 3em; }</style>

<br/>


<br/>

> Tom does silly things with lots of spreadsheets.
> =================================================


<br/>

<br/>

<br/>

<br/>

> "Open data"!?
> ==============


<br/>

<br/>

<br/>

<br/>

<br/>

![Plot of dataset counts by site](/dada/socrata-summary/figure/big_portals_datasets.png)


<br/>

<br/>

<br/>

<br/>

> Why nobody knows what's in these datasets
> =========================================


<br/>

<br/>

[![Tom holding a letterpress print of a CSV file](/dada/print-formaldehyde/csv-print.jpg)](/dada/print-formaldehyde)


<br/>
"file with lots of numbers in it",

<br/>

![A spreadsheet](bus-spreadsheet.png)


<br/>

<br/>

<br/>


<br/>

> Open data guidelines
> ======================
> * Open Knowledge Foundation [Open Data Census](http://census.okfn.org/)
> * Tim Berners-Lee [Five Stars](http://inkdroid.org/journal/2010/06/04/the-5-stars-of-open-linked-data/) of open linked data.
> * Open Government Working Group [8 Principles of Open Government Data](http://www.opengovdata.org/home/8principles)
> * Sunlight Foundation [Open Data Policy Guidelines](http://sunlightfoundation.com/opendataguidelines/)
> * Open Data Institute [Certificates](https://certificates.theodi.org/)


<br/>

<br/>

<br/>

<br/>

<br/>


<br/>

<br/>

<br/>

<br/>

<br/>

> Standard Schemas
> =================
> * RSS
> * Atom
> * [GeoJson](http://geojson.org/)
> * &c.


<br/>

<br/>

<br/>

![](hovering-schema.png)


<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

![slide about different organizations](standards.png)


<br/>

<br/>

<br/>

<br/>


<br/>

1. Reading the whole spreadsheet
2. Documenting spreadsheets so it's easier to read them
3. Standardizing formats so it's even easier to read them


<br/>

<br/>

> Graphs and stuff
> =================


<br/>

<br/>


<br/>

![](sncf-tableau.png)


<br/>

![](sncf-analyse.png)


<br/>

![](lombardia-grafico.png)


<br/>

<br/>


<br/>

<br/>

<br/>

<br/>

<br/>

> Looking at lots of spreadsheets
> ----------------------------------
> 1. Reading the whole spreadsheet
> 2. Documenting spreadsheets so it's easier to read them
> 3. Standardizing formats so it's even easier to read them
> 4. Graphs and stuff


<br/>

<br/>

<br/>

> Word of mouth
> ================


<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

[![Nicole Neditch](nicole.jpg)](https://twitter.com/nneditch)
[![Noel Hidalgo](noel.jpg)](http://noneck.org/)


<br/>

<br/>

<br/>

<br/>

[![Chris Metcalf](chris.jpg)](http://chrismetcalf.net/)
[![Tim Wisniewski](tim.jpg)](http://timwis.com/)


<br/>

<br/>

<br/>

<br/>

<br/>

[![](top-ten-elevator-offenders.png)](http://www.nyc.gov/html/dob/html/safety/top10_elev_offenders.shtml)


<br/>
"Top Ten Elevator Offenders" dataset and couldn't stop laughing, mainly

<br/>

<br/>

<br/>


<br/>

<br/>

<br/>

<br/>

<br/>

> What's in all these data
> =============================================================


<br/>

<br/>

<br/>

> I like recursion
> ==================


<br/>

<br/>

> I heard you like spreadsheets
> ----------------------------------
> ![](/dada/dataset-as-datapoint/spreadsheet-spreadsheet.png)


<br/>

<br/>

<br/>


<br/>

<br/>

![Plot of dataset counts by site](/dada/socrata-summary/figure/big_portals_datasets.png)


<br/>

<br/>

> **Column names**: "grade", "year", "demographic", "number_tested", "mean_scale_score", "num_level_1", "pct_level_1", "num_level_2", "pct_level_2", "num_level_3", "pct_level_3", "num_level_4", "pct_level_4", "num_level_3_and_4", "pct_level_3_and_4"
>
> **Datasets with these column names**:
>
> * [Math Test Results 2006-2012 - Citywide - Gender](https://data.cityofnewyork.us/d/2bh6-qmgg)
> * [Math Test Results 2006-2012 - Citywide - Ethnicity](https://data.cityofnewyork.us/d/vve2-26rs)
> * [English Language Arts (ELA) Test Results 2006-2012 - Citywide - SWD](https://data.cityofnewyork.us/d/d72n-ivax)
> * [English Language Arts (ELA) Test Results 2006-2012 - Citywide - ELL](https://data.cityofnewyork.us/d/72db-huua)
> * [Math Test Results 2006-2012 - Citywide - SWD](https://data.cityofnewyork.us/d/ufu7-zp25)
> * [English Language Arts (ELA) Test Results 2006-2012 - Citywide - All Students](https://data.cityofnewyork.us/d/89di-hi4s)
> * [Math Test Results 2006-2012 - Citywide - ELL](https://data.cityofnewyork.us/d/ngbi-cq85)
> * [English Language Arts (ELA) Test Results 2006-2012 - Citywide - Gender](https://data.cityofnewyork.us/d/cs9m-cz6f)
> * [Math Test Results 2006-2012 - Citywide - All Students](https://data.cityofnewyork.us/d/fxwm-3t4n)
> * [English Language Arts (ELA) Test Results 2006-2012 - Citywide - Ethnicity](https://data.cityofnewyork.us/d/p5w7-g72z)


<br/>
[{"id": "2bh6-qmgg", "name": "Math Test Results 2006-2012 - Citywide - Gender"}
, {"id": "vve2-26rs", "name": "Math Test Results 2006-2012 - Citywide - Ethnicity"}
, {"id": "d72n-ivax", "name": "English Language Arts (ELA) Test Results 2006-2012 - Citywide - SWD"}
, {"id": "72db-huua", "name": "English Language Arts (ELA) Test Results 2006-2012 - Citywide - ELL"}
, {"id": "ufu7-zp25", "name": "Math Test Results 2006-2012 - Citywide - SWD"}
, {"id": "89di-hi4s", "name": "English Language Arts (ELA) Test Results 2006-2012 - Citywide - All Students"}
, {"id": "ngbi-cq85", "name": "Math Test Results 2006-2012 - Citywide - ELL"}
, {"id": "cs9m-cz6f", "name": "English Language Arts (ELA) Test Results 2006-2012 - Citywide - Gender"}
, {"id": "fxwm-3t4n", "name": "Math Test Results 2006-2012 - Citywide - All Students"}
, {"id": "p5w7-g72z", "name": "English Language Arts (ELA) Test Results 2006-2012 - Citywide - Ethnicity"}
]

<br/>


<br/>

<br/>

<br/>


<br/>

<br/>

![Plot of dataset counts and download counts by site](/dada/socrata-summary/figure/big_portals_density_text.png)


<br/>

<br/>


<br/>

<br/>


<br/>
  s <- read.csv('~/t/socrata-analysis/socrata-deduplicated.csv')
  sum(is.na(s$nrow))                                                                                                  
[1] 476
  mean(s$nrow > 100, na.rm = T)                                                                                       
[1] 0.2507369
  mean(s$nrow > 1000, na.rm = T)                                                                                      
[1] 0.1162797
  mean(s$nrow > 10000, na.rm = T)                                                                                     
[1] 0.05230904
  mean(s$nrow > 100000, na.rm = T)                                                                                    
[1] 0.01799659

<br/>

> Dataset sizes
> ===============
> In Socrata catalogs as of last summer,
> 
> * Only 25% of datasets had more than 100 rows.
> * Only 12% of datasets had more than 1,000 rows.
> * Only 5% of datasets had more than 10,000 rows.


<br/>

<br/>

<br/>


<br/>

<br/>

<br/>


<br/>

![](/dada/socrata-formats/figure/deduplicated.png)


<br/>

<br/>

<br/>


<br/>

![](/dada/socrata-formats/figure/sf.png)


<br/>

![](/dada/socrata-formats/figure/sf-changes.png)


<br/>

<br/>

<br/>

![](/dada/socrata-formats/figure/sf-shapefile.png)


<br/>

<br/>

<br/>

<br/>

![](/dada/socrata-formats/figure/deduplicated.png)


<br/>

<br/>

<br/>

> Graphs?
> ==========


<br/>

<br/>

<br/>

![](/dada/socrata-users/figure/n.views.png)


<br/>

<br/>

<br/>

<br/>

<br/>
"citizens" analyze data.

> Main users
> ==========
> * Socrata employees
> * Socrata clients (like data.gov)
> * A bot
> * Ordinary people making lots of different queries on the same spreadsheet
> * People testing apps that take data from Socrata


<br/>

<br/>

<br/>

> Quantifying compliance with guidelines
> =======================================


<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

![](/dada/zombie-links/figure/p_link_types.png)


<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

![](/dada/zombie-links/figure/p_prop_links.png)


<br/>

<br/>

<br/>

<br/>

<br/>

> This shouldn't be interesting
> ==============================


<br/>

<br/>

<br/>

<br/>

> (Almost) Nobody knows what's in her data
> =================================================


<br/>

<br/>


<br/>

<br/>

> It's hard to search for spreadsheets
> =================================================


<br/>

<br/>

<br/>

<br/>

<br/>

![](search-delft.png)


<br/>

<br/>

<br/>

![](/dada/dataset-as-datapoint/spreadsheet-spreadsheet.png)


<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

    SELECT * FROM datasets WHERE "ncol.date" > 3;


<br/>

<br/>

![](/dada/data-about-open-data-talk-december-2-2013/unsilo.jpg)


<br/>

<br/>

<br/>

<br/>

<br/>


<br/>

<br/>

<br/>

[![](/dada/openprism/taco.png)](http://openprism.thomaslevine.com)


<br/>

<br/>

<br/>


<br/>

> Why searching for spreadsheets is hard
> ==========================================
>
> * Site-specific search
> * Naive search method


<br/>

<br/>

<br/>

<br/>


<br/>

<br/>


<br/>

<br/>

> Guessing a schema
> =======================


<br/>

<br/>

<br/>

<br/>

<br/>

> Brute-force guessing the observational unit
> ============================================


<br/>

<br/>

<br/>

<br/>

    pip3 install special_snowflake


<br/>


<br/>

<br/>

<br/>


<br/>

    "Sepal.Length","Sepal.Width","Petal.Length","Petal.Width","Species"
    5.1,3.5,1.4,0.2,"setosa"
    4.9,3,1.4,0.2,"setosa"
    4.7,3.2,1.3,0.2,"setosa"
    4.6,3.1,1.5,0.2,"setosa"
    ...


<br/>

    $ snowflake iris.csv 


<br/>

<br/>

    "Id","Sepal.Length","Sepal.Width","Petal.Length","Petal.Width","Species"
    1,5.1,3.5,1.4,0.2,"setosa"
    2,4.9,3,1.4,0.2,"setosa"
    3,4.7,3.2,1.3,0.2,"setosa"
    4,4.6,3.1,1.5,0.2,"setosa"
    ...


<br/>

    $ snowflake iris.csv 
    Id


<br/>

    "weight","Time","Chick","Diet"
    42,0,"1","1"
    51,2,"1","1"
    59,4,"1","1"
    64,6,"1","1"
    76,8,"1","1"
    ...


<br/>

<br/>

<br/>

    $ snowflake chick.csv 
    Time, Chick


<br/>

<br/>

<br/>


<br/>

<br/>

    $ wget -O poste.csv http://data.iledefrance.fr/explore/dataset/liste-des-points-de-contact-du-reseau-postal-dile-de-france/download/?format=csv
    $ snowflake poste.csv
    adresse, code_postal
    adresse, localite
    identifiant
    libelle_du_site
    wgs84


<br/>

<br/>

<br/>

<br/>
[data dictionary](http://data.iledefrance.fr/api/datasets/1.0/liste-des-points-de-contact-du-reseau-postal-dile-de-france/attachments/laposte_description_champs_pointdecontact_pdf/),

<br/>


<br/>

<br/>

<br/>

> Brute-force guessing foreign keys
> ===================================


<br/>

<br/>

<br/>

<br/>

<br/>


<br/>

<br/>

<br/>

<br/>

![](network.png)


<br/>

<br/>

![](factorial-1.png)


<br/>

<br/>

![](factorial-1-overlap.png)


<br/>

<br/>

<br/>

![](factorial-2.png)


<br/>

> Search Engine
> ================


<br/>

<br/>

![](wordsearch.png)


<br/>

<br/>

![](commasearch.png)


<br/>

<br/>

<br/>

    pip3 install commasearch                                                                            


<br/>

    , --index this.csv that.csv and.csv so.csv on.csv                                                   


<br/>

<br/>

    pluplusch --urls | , --index -


<br/>

    , --verbose http://www-static.bouldercolorado.gov/docs/opendata/2000_Construction_Permits.csv
    {"url": "http://data.ottawa.ca/storage/f/2013-04-16T201942/RingPost_Master_List_-Feb12_2013.csv", "search_columns": [4], "overlap": 4, "result_columns": [10], "nrow": 809}
    {"url": "http://data.ottawa.ca/storage/f/2013-04-16T201942/RingPost_Master_List_-Feb12_2013.csv", "search_columns": [5], "overlap": 0, "result_columns": [10], "nrow": 809}
    {"url": "http://data.ottawa.ca/storage/f/2013-04-16T201942/RingPost_Master_List_-Feb12_2013.csv", "search_columns": [6], "overlap": 0, "result_columns": [10], "nrow": 809}
    {"url": "http://data.ottawa.ca/storage/f/2013-04-16T201942/RingPost_Master_List_-Feb12_2013.csv", "search_columns": [7], "overlap": 0, "result_columns": [10], "nrow": 809}
    {"url": "http://data.ottawa.ca/storage/f/2013-04-16T201942/RingPost_Master_List_-Feb12_2013.csv", "search_columns": [8], "overlap": 1, "result_columns": [10], "nrow": 809}
    {"url": "http://data.ottawa.ca/storage/f/2013-04-16T201942/RingPost_Master_List_-Feb12_2013.csv", "search_columns": [9], "overlap": 5, "result_columns": [10], "nrow": 809}
    {"url": "http://data.ottawa.ca/storage/f/2013-04-16T201942/RingPost_Master_List_-Feb12_2013.csv", "search_columns": [10], "overlap": 138, "result_columns": [10], "nrow": 809}
    {"url": "http://data.ottawa.ca/storage/f/2013-04-16T201942/RingPost_Master_List_-Feb12_2013.csv", "search_columns": [11], "overlap": 132, "result_columns": [10], "nrow": 809}
    {"url": "http://data.ottawa.ca/storage/f/2013-04-16T201942/RingPost_Master_List_-Feb12_2013.csv", "search_columns": [12], "overlap": 556, "result_columns": [10], "nrow": 809}
    

<br/>

<br/>

    $ head -n5 2000_Construction_Permits.csv
    Case Number,Address,Assessor ID,Case Status,Category,Building Uses and Work Scopes,Permit Types, Total Project Value , Total Subpermit Value ,Applied,Approved,Issued,CO Date,Completion Date,New Res Unit,Existing Res Unit,Affordable Hsg Unit,New SF,Remodel SF,Narrative Description,Primary First Name,Primary Last Name,Primary Company,Contractor First Name,Contractor Last Name,Contractor Company,Owner1 First Name,Owner1 Last Name,Owner1 Company,Owner2 First Name,Owner2 Last Name,Owner2 Company
    PMT2000-00001,1343 WILDWOOD CT,0066684,REV,Residential,"Single Family Detached Dwelling, Existing",Mechanical, $899.00 , $899.00 ,1/7/2000,1/7/2000,12/17/2099,,,,1,,,,GAS LOG INSERT,,THE GAS CONNECTION,THE GAS CONNECTION,,THE GAS CONNECTION,THE GAS CONNECTION,ALEXANDER,BROWN,,,KATHY VOGELEY,
    PMT2000-00002,263 PEARL ST    8,0101764,N&V,Residential,"Townhomes, Existing",Mechanical," $1,250.00 "," $1,250.00 ",1/7/2000,1/7/2000,12/17/2099,,,,1,,,,GAS LOGS IN FIREPLACE AND GAS STOVE IN KITCHEN,,NORM'S PLUMBING AND HEATING,NORM'S PLUMBING AND HEATING,,NORM'S PLUMBING AND HEATING,NORM'S PLUMBING AND HEATING,ROBERT,JUSTIS,,LESLIE,N,
    PMT2000-00003,3000 WALNUT ST,0065954,CLS,NonResidential,"Commercial/Retail, Existing",Electrical, $600.00 , $600.00 ,1/7/2000,1/7/2000,12/17/2099,,,,,,,,ELECTRICAL WIRING FOR 2 ELECTRIC SIGNS,,"AAA ELECTRIC COMPANY, INC.","AAA ELECTRIC COMPANY, INC.",,"AAA ELECTRIC COMPANY, INC.","AAA ELECTRIC COMPANY, INC.",TERRENCE,OCONNOR,,,MIDAS,
    PMT2000-00004,2515 BROADWAY,0003260,N&V,Residential,"Single Family Detached Dwelling, Existing",Mechanical," $1,950.00 "," $1,950.00 ",1/7/2000,1/7/2000,12/17/2099,,,,1,,,,INSTALL 65000 BTU SPACE HEATER IN LIVING ROOM,,CONTROL SERVICE CENTER INC,CONTROL SERVICE CENTER INC,,CONTROL SERVICE CENTER INC,CONTROL SERVICE CENTER INC,HOSPITAL,COMMUNITY,,,MOCK PROPERTY MANAGEMENT,
    

<br/>

    $ head -n5 RingPost_Master_List_-Feb12_2013.csv
    Post_ID,Mid_block_ID,Street_1,Street_2,Street_3,Side,Adjacent_to,latitude,longitude,Core,Notes
    1,1,Laurier Ave E,Henderson Ave,Nelson St,South,210 Laurier Ave E,45.42571,-75.681794,New,
    2,1,Laurier Ave E,Henderson Ave,Nelson St,South,210 Laurier Ave E,45.425816,-75.681558,New,
    3,1,Laurier Ave E,Henderson Ave,Nelson St,South,238 Laurier Ave E,45.425902,-75.681247,New,
    4,2,Laurier Ave E,Cumberland St,Waller St,North,75 Laurier Ave E,45.42408,-75.686239,New,


<br/>


<br/>


<br/>

<br/>

## Review

<br/>

<br/>

<br/>

> Attempts at understanding all these datasets
> =================================================================
> * Write data dictionaries, &c.
> * Agree on standards
> * Make graphs and stuff
> * Ask someone


<br/>

<br/>

<br/>

<br/>

<br/>

> My approach: Brute force
> =========================


<br/>

<br/>

<br/>

![](/dada/zombie-links/figure/p_prop_links.png)


<br/>

<br/>

<br/>

> ???
> ====


<br/>

<br/>

<br/>

> "Search"


<br/>

<br/>

<br/>

![](/dada/data-about-open-data-talk-december-2-2013/unsilo.jpg)


<br/>

<br/>

<br/>

<br/>

[![](/dada/openprism/taco.png)](http://openprism.thomaslevine.com)


<br/>

<br/>

<br/>


<br/>

<br/>

<br/>

![](wordsearch.png)


<br/>

<br/>

![](commasearch.png)


<br/>

<br/>

<br/>

> Relevance
> =================


<br/>

<br/>

> ## 1. Nobody understands her own data. (You're not the only one.)


<br/>

<br/>

<br/>

<br/>

> ## 2. If people aren't documenting their data, don't expect them to document their data


<br/>

<br/>

<br/>


<br/>

<br/>

> ## 3. Brute force can help you understand your data


<br/>

<br/>
